---
layout: post
title: Vue.js | Vuex
category: Vue.js
tags: [vue.js]
comments: true
---

> Vue.js 3.x / Vue-CLI 5

ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ë³µì¡í•´ì§€ë©´ì„œ ì»´í¬ë„ŒíŠ¸ ìˆ˜ê°€ ë§ì•„ì§€ë©´ ì»´í¬ë„ŒíŠ¸ ê°„ì˜ ë°ì´í„° ì „ë‹¬ì´ ì–´ë ¤ì›Œì§„ë‹¤.

`Vuex`ëŠ” **<mark style='background-color: #dcffe4'>Vue</mark>**ì—ì„œ ëª¨ë“  ì»´í¬ë„ŒíŠ¸ê°€ ì ‘ê·¼ ê°€ëŠ¥í•œ ì¤‘ì•™ ì§‘ì¤‘ì‹ ì €ì¥ì†Œ(store)ë¥¼ ì œê³µí•´ì£¼ê³  ë°ì´í„° ê´€ë¦¬ ë° ìƒíƒœ ê´€ë¦¬ë¥¼ í•  ìˆ˜ ìˆë„ë¡ í•´ì£¼ëŠ” ìƒíƒœ ê´€ë¦¬ íŒ¨í„´ + ë¼ì´ë¸ŒëŸ¬ë¦¬ë‹¤.

ì¦‰, ë°ì´í„°ë¥¼ `store`ì— ì €ì¥í•˜ê³ , í”„ë¡œì íŠ¸ ì „ì²´ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ í•´ì£¼ëŠ”ê²ƒì´ `Vuex`ë‹¤.

ê·¸ë¦¬ê³  ì¤‘ì•™ ì €ì¥ì†Œì— ì €ì¥ëœ ë°ì´í„°ëŠ” ì‰½ê²Œ ë°”ê¿€ ìˆ˜ ìˆëŠ”ê²Œ ì•„ë‹ˆê³ , `íŠ¹ì • í•¨ìˆ˜(mutations, actions)`ë¥¼ í†µí•´ì„œë§Œ ë°ì´í„° ë³€ê²½ì´ ê°€ëŠ¥í•˜ê³  ë³€ê²½ ìƒíƒœë¥¼ ê´€ë¦¬í•  ìˆ˜ ìˆë‹¤.

---

## Vuex ê¸°ë³¸ êµ¬ì¡°

```javascript
export default createStore() {
    state: {},
    getters: {},
    mutations: {},
    actions: {},
    modules: {},
}
```

---

### State

`state`ëŠ” í”„ë¡œì íŠ¸ ì „ì²´ì—ì„œ ê³µí†µìœ¼ë¡œ ì‚¬ìš©í•  ë³€ìˆ˜ë¥¼ ì •ì˜í•˜ëŠ” ê³³ì´ë‹¤. ì¼ë°˜ Vue ì»´í¬ë„ŒíŠ¸ êµ¬ì¡°ì˜ `data` ë¶€ë¶„ê³¼ ê°™ì€ ì—­í• ì„ í•œë‹¤ê³  ë³´ë©´ ëœë‹¤.

---

### Getters

`getters`ëŠ” `store`ë¥¼ ìœ„í•œ `computed`ë¼ê³  ìƒê°í•˜ë©´ ëœë‹¤.

ì˜ˆë¥¼ ë“¤ì–´ ì‡¼í•‘ëª° ì›¹ì‚¬ì´íŠ¸ì—ì„œ ì¥ë°”êµ¬ë‹ˆì— ë¬¼ê±´ì„ ì¶”ê°€í•˜ë©´ ë°”ë¡œ ì¥ë°”êµ¬ë‹ˆ ì•„ì´ì½˜ì— ìˆ«ìê°€ ì¦ê°€í•˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.

ì´ ê²½ìš° ì¥ë°”êµ¬ë‹ˆì— ë‹´ê¸´ ì œí’ˆ ë°ì´í„°ë¥¼ ì €ì¥ì†Œì˜ `state`ì— ë³€ìˆ˜ë¡œ ê´€ë¦¬í•˜ê³  ìˆë‹¤ë©´, ì¥ë°”êµ¬ë‹ˆì— ë‹´ê¸´ ì œí’ˆ ìˆ˜ ë“±ì„ `getters`ë¡œ ì •ì˜í•˜ì—¬ ì‰½ê²Œ ê°€ì ¸ì˜¬ ìˆ˜ ìˆëŠ” ê²ƒì´ë‹¤.

---

### Mutations

`Vuex`ëŠ” `state`ì— ì •ì˜ëœ ë³€ìˆ˜ë¥¼ ì§ì ‘ ë³€ê²½í•˜ëŠ” ê²ƒì„ í—ˆìš©í•˜ì§€ ì•ŠëŠ”ë‹¤. ë°˜ë“œì‹œ `mutations`ë¥¼ ì´ìš©í•´ì„œ ë³€ê²½ì„ í•´ì•¼ í•œë‹¤.
`mutations`ì€ <font color='#1E90FF'>ë™ê¸°(Sync) ì²˜ë¦¬</font>ë¥¼ í†µí•´ `state`ì— ì •ì˜ëœ ë³€ìˆ˜ì˜ ë³€ê²½ì‚¬í•­ì„ ì¶”ì í•  ìˆ˜ ìˆê²Œ í•´ì¤€ë‹¤.

---

### Actions

`mutations`ì™€ ë§¤ìš° ìœ ì‚¬í•˜ë©° `actions`ì— ì •ì˜ëœ í•¨ìˆ˜ì—ì„œëŠ” ê²°êµ­ì€ `mutations`ì— ì •ì˜í•œ í•¨ìˆ˜ë¥¼ `ì»¤ë°‹(commit)`ì‹œì¼œì„œ `state`ë¥¼ ë³€ê²½í•œë‹¤.

**<mark style='background-color: #dcffe4'>mutationsê°€ ìˆëŠ”ë° ì™œ êµ³ì´ actionsë¥¼ í†µí•´ mutationsë¥¼ ì‹¤í–‰í•˜ëŠ” ë²ˆê±°ë¡œìš´ ì§“ì„ í• ê¹Œ?</mark>**

- `actions`ì— ì •ì˜ëœ í•¨ìˆ˜ ì•ˆì—ì„œëŠ” ì—¬ëŸ¬ ê°œì˜ mutationì„ ì‹¤í–‰ ì‹œí‚¬ ìˆ˜ ìˆë‹¤.
- `mutations`ì™€ ë‹¬ë¦¬ <font color='red'>ë¹„ë™ê¸° ì²˜ë¦¬</font>ê°€ ê°€ëŠ¥í•˜ë‹¤.

ì¦‰, `actions`ì— ë“±ë¡ëœ í•¨ìˆ˜ëŠ” ë¹„ë™ê¸° ì²˜ë¦¬ í›„ `mutations`ë¥¼ `ì»¤ë°‹`í•  ìˆ˜ ìˆì–´ì„œ `ì €ì¥ì†Œ(store)`ì—ì„œ ë¹„ë™ê¸° ì²˜ë¦¬ ë¡œì§ì„ ê´€ë¦¬í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” ê²ƒì´ë‹¤.

`actions í•¸ë“¤ëŸ¬`ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ `Store` ì¸ìŠ¤í„´ìŠ¤ì˜ ë™ì¼í•œ ë©”ì†Œë“œ/í”„ë¡œí¼í‹° ì •ë³´ë¥¼ ê°€ì§€ê³  ìˆëŠ” `ì»¨í…ìŠ¤íŠ¸(context) ê°ì²´`ë¥¼ ë°›ëŠ”ë‹¤.

```javascript
const { commit, state } = context;
context.commit, context.state;
```

---

## Mutations vs Actions

ì˜ˆë¥¼ ë“¤ì–´ ì‡¼í•‘ëª° ì¥ë°”êµ¬ë‹ˆì˜ ëª©ë¡ì´ ë¡œê·¸ì•„ì›ƒí•˜ëŠ” ìˆœê°„ ì‚¬ë¼ì§€ê±°ë‚˜ í˜¹ì€ ë¸Œë¼ìš°ì € ìºì‰¬ì— ë‚¨ê²¨ë‘ì–´ ë³´ì—¬ì§€ê²Œ í•˜ë˜ê°€ í•˜ëŠ” ë“±ì˜
ì„œë²„ì˜ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ê´€ë¦¬ë¥¼ í•˜ì§€ ì•ŠëŠ” ì´ëŸ° ì„±ê²©ì˜ `store`ë„ í•„ìš”í•˜ë‹¤. ì´ëŸ° ê²½ìš°ì—” `mutations`ë§Œìœ¼ë¡œ ì¶©ë¶„í•˜ë‹¤.

ì´ë ‡ê²Œ ì–´ë–¤ ë°ì´í„°ë¥¼ ì¤‘ì•™ ì €ì¥ì†Œì— ê´€ë¦¬í•˜ê³  ì²˜ë¦¬í•˜ëŠëƒì— ë”°ë¼ì„œ `mutations`ë§Œìœ¼ë¡œ ì¶©ë¶„í•œ ê²ƒì´ ìˆê³  `actions`ë¥¼ ì¨ì•¼ í•˜ëŠ” ê²½ìš°ê°€ ìˆë‹¤.

#### í˜¸ì¶œ ë°©ë²•

```javascript
methods: {
  // Mutations ë¥¼ ì´ìš©í•  ë•Œ
  addItem() {
    this.$store.commit('todo/add'); // commit ì‚¬ìš©
  }
  // Actions ë¥¼ ì´ìš©í•  ë•Œ
  addItem() {
    this.$store.dispatch('todo/add'); // dispatch ì‚¬ìš©
  }
},

```

---

## Vuex ì‚¬ìš©í•´ë³´ê¸°

#### ğŸ”— Todo ë¦¬ìŠ¤íŠ¸ë¥¼ ë§Œë“¤ì–´ë³´ì.

#### > src / main.js

```javascript
import { createApp } from "vue";
import App from "./App.vue";
import router from "./router";
import store from "./store";
// index.js íŒŒì¼ì„ ì‚¬ìš©í•  ê²½ìš° import ë¬¸ì—ì„œ í•´ë‹¹ í´ë”ë§Œ ì‘ì„±ê¹Œì§€ë§Œ íŒŒì¼ê²½ë¡œë¥¼ ì‘ì„±í•´ì¤˜ë„ ìë™ìœ¼ë¡œ index.js íŒŒì¼ì„ import í•˜ê²Œ ëœë‹¤.

const app = createApp(App);
app.user(store);
app.use(router);
app.mount("#app");
```

`main.js`ì— ì´ë ‡ê²Œ ë“±ë¡ì´ ë˜ì–´ìˆìœ¼ë©´ **<mark style='background-color: #dcffe4'>Vue ì»´í¬ë„ŒíŠ¸</mark>**ì—ì„œ `this.$store`ë¡œ ì ‘ê·¼ì´ ê°€ëŠ¥í•˜ë‹¤.

---

#### âœ“ `store`ëŠ” ëª¨ë“ˆí˜•íƒœë¡œ ë¶„ë¦¬í•´ì„œ ê´€ë¦¬í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.

ğŸ“¦store  
â”£ ğŸ“œindex.js  
â”— ğŸ“œtodo.js

í•œ íŒŒì¼ì—ì„œ ëª¨ë“ ê±¸ ê´€ë¦¬í•˜ë‹¤ ë³´ë©´ ë³µì¡í•´ì§€ê¸°ë„ í•˜ê³  ì—¬ëŸ¬ëª…ì˜ ê°œë°œìë“¤ì´ ê°™ì´ ê°œë°œì„ í•˜ëŠ” ê²½ìš° ë³‘í•©í•˜ë‹¤ ì¶©ëŒì´ ë‚˜ëŠ” ê²½ìš°ê°€ ìƒê¸°ê¸° ë§ˆë ¨ì´ê¸° ë•Œë¬¸ì´ë‹¤.

#### > src / store / index.js

```javascript
import { createStore } from "vuex";
import { todo } from "./todo";
// vuexì— ì €ì¥ë˜ëŠ” ê°’ë“¤ì„ ì‚¬ìš©í•˜ëŠ” ì›¹ë¸Œë¼ìš°ì €ì˜ localstorageì— ì €ì¥
import persistedstate from "vuex-persistedstate";

export default createStore({
  modules: {
    // todo : namespace
    todo: todo,
  },
  plugins: [persistedstate({ paths: ["todo.todos"] })], // í™”ë©´ì´ ìƒˆë¡œê³ ì¹¨ë¼ë„ ì˜êµ¬íˆ ë°ì´í„° ë³´ì¡´
});
```

- `persistedstat` ëª¨ë“ˆ - vuexì— ì €ì¥ë˜ëŠ” ê°’ë“¤ì„ ì‚¬ìš©í•˜ëŠ” ì›¹ë¸Œë¼ìš°ì €ì˜ `localstorage`ì— ì €ì¥  
   ex) `ì¥ë°”êµ¬ë‹ˆ` ê°™ì´ ë°ì´í„°ê°€ ë‚¨ì•„ìˆì–´ë„ ìƒê´€ì—†ëŠ” ê²½ìš°ì— ì‚¬ìš©

  <img width="720" alt="Screen Shot 2022-09-02 at 3 22 02 PM" src="https://user-images.githubusercontent.com/76654131/188074662-dd3b85a1-12f9-4151-8bd5-5aba42cfe4df.png">

- `vue-cookies` ëª¨ë“ˆ - ì‚¬ìš©í•˜ëŠ” ì›¹ë¸Œë¼ìš°ì € `cookies`ì— ì €ì¥  
   ex) `ìœ ì € ì •ë³´` ê°™ì´ ì¼ì •ì‹œê°„ì´ ì§€ë‚˜ë©´ ë°ì´í„°ë¥¼ ì‚¬ë¼ì§€ê²Œ í•´ì•¼í•˜ëŠ” ê²½ìš°ì— ì‚¬ìš©

  > npm install vue-cookies

  <img width="718" alt="Screen Shot 2022-09-02 at 3 26 11 PM" src="https://user-images.githubusercontent.com/76654131/188074667-0ff989de-1561-4c19-920c-3bfc09d9689f.png">

---

#### > src / store / todo.js

```javascript
export const todo = {
  namespaced: true,
  state() {
    return {
      todos: [
        { id: 1, title: "todo 1", done: true },
        { id: 2, title: "todo 2", done: false },
        { id: 3, title: "todo 3", done: false },
      ],
    };
  },
  getters: {
    todosCount(state) {
      return state.todos.length;
    },
    doneTodosCount(state) {
      return state.todos.filter((todo) => todo.done).length;
    },
    notDoneTodosCount(state) {
      return state.todos.filter((todo) => !todo.done).length;
    },
  },
  mutations: {
    add(state, item) {
      state.todos.push(item);
    },
    remove(state, id) {
      state.todos = state.todos.filter((todo) => todo.id !== id);
    },
    doneYN(state, doneStatus) {
      state.todos.filter((todo) => todo.id === doneStatus.id)[0].done =
        doneStatus.done;
    },
  },
  actions: {
    add({ commit }, item) {
      // const {commit, state} = context
      // context.commit, context.state

      // ì„œë²„ë‘ í†µì‹ . fetch, axios
      commit("add", item);
    },
    // add2: async ({ commit }, item) => {
    //   await fetch('', {})
    // }
  },
};
```

---

#### > src / views / TodoView.vue

```html
<template>
  <div>
    <div>{{ todos }}</div>
    <div>í• ì¼ ëª©ë¡ ì „ì²´ìˆ˜ : {{ todosCount }}</div>
    <div>ì™„ë£Œ ëª©ë¡ ìˆ˜ : {{ doneTodosCount }}</div>
    <div>ë¯¸ì™„ë£Œ ëª©ë¡ ìˆ˜ : {{ notDoneTodosCount }}</div>
    <div>
      <label for="todo" class="form-label">í• ì¼</label>
      <input
        type="text"
        name=""
        id="todo"
        class="form-control"
        v-model="todo"
      />
      <button class="btn btn-primary" @click="addItem">ì¶”ê°€(mutation)</button>
      <button class="btn btn-primary" @click="addItem2">ì¶”ê°€(action)</button>
    </div>
    <div>
      <table class="table table-bordered table-striped">
        <thead>
          <tr>
            <th>Todo ID</th>
            <th>í• ì¼</th>
            <th>ì™„ë£Œì—¬ë¶€</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <tr :key="todo.id" v-for="todo in todos">
            <td>{{ todo.id }}</td>
            <td>{{ todo.title }}</td>
            <td>
              <div class="form-check form-switch">
                <input
                  class="form-check-input"
                  type="checkbox"
                  role="switch"
                  id="flexSwitchCheckChecked"
                  :checked="!todo.done"
                  @change="doneYN(todo.id, $event)"
                />
              </div>
            </td>
            <td>
              <button
                class="btn btn-danger btn-sm"
                @click="removeItem(todo.id)"
              >
                ì‚­ì œ
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</template>
```

```javascript
export default {
  components: {},
  data() {
    return {
      todo: ''
    }
  },
  // namespace : todoë¡œ ì ‘ê·¼
  computed: {
    todos() {
      return this.$store.state.todo.todos
    },
    todosCount() {
      return this.$store.getters['todo/todosCount']
    },
    doneTodosCount() {
      return this.$store.getters['todo/doneTodosCount']
    },
    notDoneTodosCount() {
      return this.$store.getters['todo/notDoneTodosCount']
    }
  },
  setup() {},
  created() {},
  mounted() {},
  unmounted() {},
  methods: {
    addItem() {
      this.$store.commit('todo/add', { id: 4, title: this.todo, done: false })
    },
    removeItem(id) {
      this.$store.commit('todo/remove', id)
    },
    doneYN(id, event) {
      this.$store.commit('todo/doneYN', { id: id, done: !event.target.checked })
    },
    addItem2() {
      this.$store.dispatch('todo/add', { id: 4, title: this.todo, done: false })
    }
  }
}
</script>
```

---

<img width="717" alt="Screen Shot 2022-09-02 at 2 54 09 PM" src="https://user-images.githubusercontent.com/76654131/188069399-44222ebe-b87b-4ca9-b8ea-2cce3e3fd919.png">

<br>
<br>
<br>

> **Reference**  
> ë³¸ í¬ìŠ¤íŒ…ì€ ì•„ë˜ ì‚¬ì´íŠ¸ë¥¼ ì°¸ì¡° ë° ì¸ìš©í•˜ì—¬ ê°œì¸ê³µë¶€ ìš©ë„ë¡œ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.  
> ì˜ëª»ëœ ë‚´ìš© í”¼ë“œë°± ì£¼ì‹œë©´ ë°˜ì˜í•˜ê² ìŠµë‹ˆë‹¤. ê°ì‚¬í•©ë‹ˆë‹¤.  
> [ê°œë°œìì˜í’ˆê²©](https://www.youtube.com/c/ê°œë°œìì˜í’ˆê²©)  
> [Vue.js í”„ë¡œì íŠ¸ íˆ¬ì… ì¼ì£¼ì¼ ì „](http://www.yes24.com/Product/Goods/101926719)
